<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Manager - Gerenciador de Prompts para IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-300">
    <div class="container mx-auto px-4 py-8">
        <!-- Cabeçalho -->
        <header class="mb-8">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-gray-800 dark:text-white flex items-center gap-2">
                        <i class="fas fa-robot text-primary-500"></i>
                        Prompt Manager
                    </h1>
                    <p class="text-gray-600 dark:text-gray-400">Organize e reutilize seus prompts para Inteligência Artificial</p>
                </div>
                
                <!-- Botão Light/Dark Mode -->
                <button id="theme-toggle" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300">
                    <i id="theme-icon" class="fas fa-moon"></i>
                </button>
            </div>
        </header>

        <!-- Painel principal -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Barra lateral -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Formulário para adicionar prompt -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow dark:shadow-gray-700/30 p-4 transition-colors duration-300">
                    <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-200 mb-4">Adicionar Prompt</h2>
                    <form id="prompt-form" class="space-y-4">
                        <div>
                            <label for="title" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Título</label>
                            <input type="text" id="title" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300">
                        </div>
                        
                        <div>
                            <label for="category" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Categoria</label>
                            <div class="flex gap-2">
                                <select id="category" class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300">
                                    <!-- Categorias serão carregadas dinamicamente -->
                                </select>
                                <button type="button" id="manage-categories-btn" class="px-3 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-300">
                                    <i class="fas fa-cog"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div>
                            <label for="prompt-text" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Prompt</label>
                            <textarea id="prompt-text" rows="4" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300"></textarea>
                        </div>
                        
                        <div>
                            <label for="tags" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tags (separadas por vírgula)</label>
                            <input type="text" id="tags" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300">
                        </div>
                        
                        <button type="submit" class="w-full bg-primary-500 hover:bg-primary-600 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center justify-center gap-2">
                            <i class="fas fa-plus"></i>
                            Adicionar Prompt
                        </button>
                    </form>
                </div>

                <!-- Controles de importação/exportação -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow dark:shadow-gray-700/30 p-4 transition-colors duration-300">
                    <h2 class="text-xl font-semibold text-gray-700 dark:text-gray-200 mb-4">Importar/Exportar</h2>
                    <div class="space-y-3">
                        <button id="export-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center justify-center gap-2">
                            <i class="fas fa-file-export"></i>
                            Exportar para JSON
                        </button>
                        
                        <div class="relative">
                            <input type="file" id="import-file" accept=".json" class="hidden">
                            <button id="import-btn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center justify-center gap-2">
                                <i class="fas fa-file-import"></i>
                                Importar de JSON
                            </button>
                        </div>
                        
                        <button id="clear-btn" class="w-full bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center justify-center gap-2">
                            <i class="fas fa-trash"></i>
                            Limpar Todos os Prompts
                        </button>
                    </div>
                </div>
            </div>

            <!-- Área de listagem de prompts -->
            <div class="lg:col-span-3">
                <!-- Filtros e ordenação -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow dark:shadow-gray-700/30 p-4 mb-6 transition-colors duration-300">
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                        <div class="flex flex-col sm:flex-row gap-4">
                            <div>
                                <label for="filter-category" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Filtrar por Categoria</label>
                                <select id="filter-category" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300">
                                    <option value="all">Todas as Categorias</option>
                                    <!-- Categorias serão carregadas dinamicamente -->
                                </select>
                            </div>
                            
                            <div>
                                <label for="sort-by" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ordenar por</label>
                                <select id="sort-by" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300">
                                    <option value="title">Título (A-Z)</option>
                                    <option value="title-desc">Título (Z-A)</option>
                                    <option value="category">Categoria</option>
                                    <option value="date">Data (Mais Recente)</option>
                                    <option value="date-desc">Data (Mais Antigo)</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="flex items-end">
                            <div class="relative">
                                <input type="text" id="search" placeholder="Buscar prompts..." class="w-full md:w-64 px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors duration-300">
                                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lista de prompts -->
                <div id="prompts-container" class="space-y-4">
                    <!-- Os prompts serão inseridos aqui dinamicamente -->
                </div>

                <!-- Mensagem quando não há prompts -->
                <div id="empty-state" class="bg-white dark:bg-gray-800 rounded-lg shadow dark:shadow-gray-700/30 p-8 text-center transition-colors duration-300">
                    <i class="fas fa-inbox text-gray-300 dark:text-gray-600 text-5xl mb-4"></i>
                    <h3 class="text-xl font-medium text-gray-700 dark:text-gray-300 mb-2">Nenhum prompt adicionado</h3>
                    <p class="text-gray-500 dark:text-gray-400 mb-4">Comece adicionando seu primeiro prompt usando o formulário ao lado.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para visualizar/editar prompt -->
    <div id="prompt-modal" class="fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center p-4 z-50 hidden transition-colors duration-300">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl dark:shadow-gray-900/50 w-full max-w-2xl max-h-[90vh] overflow-y-auto transition-colors duration-300">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 id="modal-title" class="text-2xl font-bold text-gray-800 dark:text-white">Detalhes do Prompt</h2>
                    <button id="close-modal" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Título</label>
                        <p id="modal-prompt-title" class="text-lg font-medium text-gray-900 dark:text-white"></p>
                    </div>
                    
                    <div class="flex gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Categoria</label>
                            <span id="modal-prompt-category" class="inline-block px-2 py-1 text-xs font-medium rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200"></span>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data</label>
                            <p id="modal-prompt-date" class="text-sm text-gray-600 dark:text-gray-400"></p>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tags</label>
                        <div id="modal-prompt-tags" class="flex flex-wrap gap-2"></div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Prompt</label>
                        <div id="modal-prompt-text" class="bg-gray-100 dark:bg-gray-700 p-4 rounded-md whitespace-pre-wrap text-gray-900 dark:text-gray-100"></div>
                    </div>
                </div>
                
                <div class="flex justify-end gap-2 mt-6">
                    <button id="copy-prompt" class="bg-primary-500 hover:bg-primary-600 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center gap-2">
                        <i class="fas fa-copy"></i>
                        Copiar Prompt
                    </button>
                    <button id="edit-prompt" class="bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center gap-2">
                        <i class="fas fa-edit"></i>
                        Editar
                    </button>
                    <button id="delete-prompt" class="bg-red-500 hover:bg-red-600 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center gap-2">
                        <i class="fas fa-trash"></i>
                        Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para gerenciar categorias -->
    <div id="categories-modal" class="fixed inset-0 bg-black bg-opacity-50 dark:bg-opacity-70 flex items-center justify-center p-4 z-50 hidden transition-colors duration-300">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl dark:shadow-gray-900/50 w-full max-w-md max-h-[90vh] overflow-y-auto transition-colors duration-300">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Gerenciar Categorias</h2>
                    <button id="close-categories-modal" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <!-- Formulário para adicionar categoria -->
                    <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Adicionar Nova Categoria</h3>
                        <form id="category-form" class="space-y-3">
                            <div>
                                <label for="new-category-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nome da Categoria</label>
                                <input type="text" id="new-category-name" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-600 text-gray-900 dark:text-white transition-colors duration-300">
                            </div>
                            
                            <div>
                                <label for="new-category-color" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Cor</label>
                                <select id="new-category-color" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-600 text-gray-900 dark:text-white transition-colors duration-300">
                                    <option value="blue">Azul</option>
                                    <option value="green">Verde</option>
                                    <option value="purple">Roxo</option>
                                    <option value="yellow">Amarelo</option>
                                    <option value="pink">Rosa</option>
                                    <option value="indigo">Indigo</option>
                                    <option value="red">Vermelho</option>
                                    <option value="gray">Cinza</option>
                                </select>
                            </div>
                            
                            <button type="submit" class="w-full bg-primary-500 hover:bg-primary-600 text-white font-medium py-2 px-4 rounded-md transition duration-200 flex items-center justify-center gap-2">
                                <i class="fas fa-plus"></i>
                                Adicionar Categoria
                            </button>
                        </form>
                    </div>
                    
                    <!-- Lista de categorias -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-3">Categorias Existentes</h3>
                        <div id="categories-list" class="space-y-2 max-h-60 overflow-y-auto">
                            <!-- Categorias serão carregadas dinamicamente -->
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end gap-2 mt-6">
                    <button id="close-categories-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-md transition duration-200">
                        Fechar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Inicialização da aplicação
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos DOM
            const promptForm = document.getElementById('prompt-form');
            const promptsContainer = document.getElementById('prompts-container');
            const emptyState = document.getElementById('empty-state');
            const exportBtn = document.getElementById('export-btn');
            const importBtn = document.getElementById('import-btn');
            const importFile = document.getElementById('import-file');
            const clearBtn = document.getElementById('clear-btn');
            const filterCategory = document.getElementById('filter-category');
            const sortBy = document.getElementById('sort-by');
            const searchInput = document.getElementById('search');
            const promptModal = document.getElementById('prompt-modal');
            const closeModal = document.getElementById('close-modal');
            const copyPromptBtn = document.getElementById('copy-prompt');
            const editPromptBtn = document.getElementById('edit-prompt');
            const deletePromptBtn = document.getElementById('delete-prompt');
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');
            const manageCategoriesBtn = document.getElementById('manage-categories-btn');
            const categoriesModal = document.getElementById('categories-modal');
            const closeCategoriesModal = document.getElementById('close-categories-modal');
            const closeCategoriesBtn = document.getElementById('close-categories-btn');
            const categoryForm = document.getElementById('category-form');
            const categoriesList = document.getElementById('categories-list');
            const categorySelect = document.getElementById('category');
            
            // Estado da aplicação
            let prompts = JSON.parse(localStorage.getItem('prompts')) || [];
            let categories = JSON.parse(localStorage.getItem('categories')) || [
                { id: 'geral', name: 'Geral', color: 'gray' },
                { id: 'configuracao', name: 'Configuração de Servidor', color: 'blue' },
                { id: 'criacao', name: 'Criação de Conteúdo', color: 'green' },
                { id: 'analise', name: 'Análise de Dados', color: 'purple' },
                { id: 'programacao', name: 'Programação', color: 'yellow' },
                { id: 'design', name: 'Design', color: 'pink' }
            ];
            let currentPromptId = null;
            let editingCategoryId = null;
            
            // Verificar tema salvo
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
            }
            
            // Inicializar a interface
            updateCategoriesSelect();
            updatePromptsList();
            
            // Event Listeners
            promptForm.addEventListener('submit', addPrompt);
            exportBtn.addEventListener('click', exportPrompts);
            importBtn.addEventListener('click', () => importFile.click());
            importFile.addEventListener('change', importPrompts);
            clearBtn.addEventListener('click', clearAllPrompts);
            filterCategory.addEventListener('change', updatePromptsList);
            sortBy.addEventListener('change', updatePromptsList);
            searchInput.addEventListener('input', updatePromptsList);
            closeModal.addEventListener('click', () => promptModal.classList.add('hidden'));
            copyPromptBtn.addEventListener('click', copyPromptToClipboard);
            editPromptBtn.addEventListener('click', editPrompt);
            deletePromptBtn.addEventListener('click', deletePrompt);
            themeToggle.addEventListener('click', toggleTheme);
            manageCategoriesBtn.addEventListener('click', () => categoriesModal.classList.remove('hidden'));
            closeCategoriesModal.addEventListener('click', () => categoriesModal.classList.add('hidden'));
            closeCategoriesBtn.addEventListener('click', () => categoriesModal.classList.add('hidden'));
            categoryForm.addEventListener('submit', addCategory);
            
            // Fechar modais ao clicar fora
            promptModal.addEventListener('click', (e) => {
                if (e.target === promptModal) {
                    promptModal.classList.add('hidden');
                }
            });
            
            categoriesModal.addEventListener('click', (e) => {
                if (e.target === categoriesModal) {
                    categoriesModal.classList.add('hidden');
                }
            });
            
            // Função para alternar tema
            function toggleTheme() {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                    localStorage.setItem('theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                    localStorage.setItem('theme', 'dark');
                }
            }
            
            // Funções de categorias
            function updateCategoriesSelect() {
                // Atualizar select de categorias no formulário
                categorySelect.innerHTML = '';
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.id;
                    option.textContent = category.name;
                    categorySelect.appendChild(option);
                });
                
                // Atualizar select de filtro de categorias
                filterCategory.innerHTML = '<option value="all">Todas as Categorias</option>';
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.id;
                    option.textContent = category.name;
                    filterCategory.appendChild(option);
                });
                
                // Atualizar lista de categorias no modal
                updateCategoriesList();
                
                // Salvar categorias no localStorage
                saveCategories();
            }
            
            function updateCategoriesList() {
                categoriesList.innerHTML = '';
                
                if (categories.length === 0) {
                    categoriesList.innerHTML = '<p class="text-gray-500 dark:text-gray-400 text-center py-4">Nenhuma categoria criada</p>';
                    return;
                }
                
                categories.forEach(category => {
                    const categoryElement = document.createElement('div');
                    categoryElement.className = 'flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg';
                    categoryElement.innerHTML = `
                        <div class="flex items-center gap-3">
                            <span class="inline-block w-4 h-4 rounded-full ${getCategoryColorClass(category.color)}"></span>
                            <span class="font-medium text-gray-800 dark:text-white">${category.name}</span>
                        </div>
                        <div class="flex gap-2">
                            <button class="edit-category-btn text-blue-500 hover:text-blue-700" data-id="${category.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="delete-category-btn text-red-500 hover:text-red-700" data-id="${category.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    categoriesList.appendChild(categoryElement);
                });
                
                // Adicionar eventos aos botões
                document.querySelectorAll('.edit-category-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const categoryId = e.currentTarget.dataset.id;
                        editCategory(categoryId);
                    });
                });
                
                document.querySelectorAll('.delete-category-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const categoryId = e.currentTarget.dataset.id;
                        deleteCategory(categoryId);
                    });
                });
            }
            
            function addCategory(e) {
                e.preventDefault();
                
                const name = document.getElementById('new-category-name').value;
                const color = document.getElementById('new-category-color').value;
                
                if (editingCategoryId) {
                    // Editar categoria existente
                    const categoryIndex = categories.findIndex(cat => cat.id === editingCategoryId);
                    if (categoryIndex !== -1) {
                        categories[categoryIndex].name = name;
                        categories[categoryIndex].color = color;
                    }
                    editingCategoryId = null;
                    document.querySelector('#category-form button[type="submit"]').innerHTML = '<i class="fas fa-plus"></i> Adicionar Categoria';
                } else {
                    // Adicionar nova categoria
                    const newCategory = {
                        id: name.toLowerCase().replace(/\s+/g, '-'),
                        name,
                        color
                    };
                    
                    // Verificar se já existe uma categoria com esse ID
                    if (categories.find(cat => cat.id === newCategory.id)) {
                        showNotification('Já existe uma categoria com esse nome', 'error');
                        return;
                    }
                    
                    categories.push(newCategory);
                }
                
                updateCategoriesSelect();
                categoryForm.reset();
                showNotification(editingCategoryId ? 'Categoria atualizada com sucesso!' : 'Categoria adicionada com sucesso!', 'success');
            }
            
            function editCategory(categoryId) {
                const category = categories.find(cat => cat.id === categoryId);
                if (!category) return;
                
                document.getElementById('new-category-name').value = category.name;
                document.getElementById('new-category-color').value = category.color;
                editingCategoryId = categoryId;
                
                document.querySelector('#category-form button[type="submit"]').innerHTML = '<i class="fas fa-save"></i> Atualizar Categoria';
                
                // Rolando para o formulário
                document.getElementById('new-category-name').focus();
            }
            
            function deleteCategory(categoryId) {
                // Verificar se a categoria está sendo usada em algum prompt
                const isCategoryUsed = prompts.some(prompt => prompt.category === categoryId);
                
                if (isCategoryUsed) {
                    showNotification('Não é possível excluir uma categoria que está sendo usada em prompts', 'error');
                    return;
                }
                
                if (confirm('Tem certeza que deseja excluir esta categoria?')) {
                    categories = categories.filter(cat => cat.id !== categoryId);
                    updateCategoriesSelect();
                    showNotification('Categoria excluída com sucesso!', 'success');
                }
            }
            
            function getCategoryColorClass(color) {
                const colorClasses = {
                    'blue': 'bg-blue-500',
                    'green': 'bg-green-500',
                    'purple': 'bg-purple-500',
                    'yellow': 'bg-yellow-500',
                    'pink': 'bg-pink-500',
                    'indigo': 'bg-indigo-500',
                    'red': 'bg-red-500',
                    'gray': 'bg-gray-500'
                };
                
                return colorClasses[color] || 'bg-gray-500';
            }
            
            function getCategoryColorClassForBadge(color) {
                const colorClasses = {
                    'blue': 'bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200',
                    'green': 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200',
                    'purple': 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200',
                    'yellow': 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200',
                    'pink': 'bg-pink-100 dark:bg-pink-900 text-pink-800 dark:text-pink-200',
                    'indigo': 'bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200',
                    'red': 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200',
                    'gray': 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200'
                };
                
                return colorClasses[color] || 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200';
            }
            
            function saveCategories() {
                localStorage.setItem('categories', JSON.stringify(categories));
            }
            
            // Funções de prompts
            function addPrompt(e) {
                e.preventDefault();
                
                const title = document.getElementById('title').value;
                const category = document.getElementById('category').value;
                const promptText = document.getElementById('prompt-text').value;
                const tags = document.getElementById('tags').value.split(',').map(tag => tag.trim()).filter(tag => tag);
                
                const newPrompt = {
                    id: Date.now().toString(),
                    title,
                    category,
                    prompt: promptText,
                    tags,
                    date: new Date().toISOString()
                };
                
                prompts.push(newPrompt);
                savePrompts();
                updatePromptsList();
                
                // Limpar formulário
                promptForm.reset();
                
                // Mostrar mensagem de sucesso
                showNotification('Prompt adicionado com sucesso!', 'success');
            }
            
            function updatePromptsList() {
                // Aplicar filtros
                let filteredPrompts = [...prompts];
                
                // Filtrar por categoria
                const categoryFilter = filterCategory.value;
                if (categoryFilter !== 'all') {
                    filteredPrompts = filteredPrompts.filter(prompt => prompt.category === categoryFilter);
                }
                
                // Filtrar por busca
                const searchTerm = searchInput.value.toLowerCase();
                if (searchTerm) {
                    filteredPrompts = filteredPrompts.filter(prompt => 
                        prompt.title.toLowerCase().includes(searchTerm) || 
                        prompt.prompt.toLowerCase().includes(searchTerm) ||
                        prompt.tags.some(tag => tag.toLowerCase().includes(searchTerm))
                    );
                }
                
                // Ordenar
                const sortValue = sortBy.value;
                switch(sortValue) {
                    case 'title':
                        filteredPrompts.sort((a, b) => a.title.localeCompare(b.title));
                        break;
                    case 'title-desc':
                        filteredPrompts.sort((a, b) => b.title.localeCompare(a.title));
                        break;
                    case 'category':
                        filteredPrompts.sort((a, b) => {
                            const categoryA = categories.find(cat => cat.id === a.category)?.name || a.category;
                            const categoryB = categories.find(cat => cat.id === b.category)?.name || b.category;
                            return categoryA.localeCompare(categoryB);
                        });
                        break;
                    case 'date':
                        filteredPrompts.sort((a, b) => new Date(b.date) - new Date(a.date));
                        break;
                    case 'date-desc':
                        filteredPrompts.sort((a, b) => new Date(a.date) - new Date(b.date));
                        break;
                }
                
                // Atualizar interface
                if (filteredPrompts.length === 0) {
                    promptsContainer.innerHTML = '';
                    emptyState.classList.remove('hidden');
                } else {
                    emptyState.classList.add('hidden');
                    promptsContainer.innerHTML = '';
                    
                    filteredPrompts.forEach(prompt => {
                        const promptElement = createPromptElement(prompt);
                        promptsContainer.appendChild(promptElement);
                    });
                }
            }
            
            function createPromptElement(prompt) {
                const promptDiv = document.createElement('div');
                promptDiv.className = 'bg-white dark:bg-gray-800 rounded-lg shadow dark:shadow-gray-700/30 p-4 hover:shadow-md transition duration-200';
                promptDiv.dataset.id = prompt.id;
                
                // Formatar data
                const date = new Date(prompt.date);
                const formattedDate = date.toLocaleDateString('pt-BR');
                
                // Encontrar a categoria
                const category = categories.find(cat => cat.id === prompt.category);
                const categoryName = category ? category.name : prompt.category;
                const categoryColor = category ? category.color : 'gray';
                const categoryClass = getCategoryColorClassForBadge(categoryColor);
                
                promptDiv.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-1">${prompt.title}</h3>
                            <div class="flex items-center gap-2 mb-2">
                                <span class="inline-block px-2 py-1 text-xs font-medium rounded-full ${categoryClass}">
                                    ${categoryName}
                                </span>
                                <span class="text-xs text-gray-500 dark:text-gray-400">${formattedDate}</span>
                            </div>
                            <p class="text-gray-600 dark:text-gray-300 line-clamp-2">${prompt.prompt}</p>
                        </div>
                        <button class="text-primary-500 hover:text-primary-700 dark:hover:text-primary-400 ml-2 view-prompt-btn">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    ${prompt.tags.length > 0 ? `
                        <div class="mt-3 flex flex-wrap gap-1">
                            ${prompt.tags.map(tag => `
                                <span class="inline-block px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded">${tag}</span>
                            `).join('')}
                        </div>
                    ` : ''}
                `;
                
                // Adicionar evento para visualizar o prompt
                promptDiv.querySelector('.view-prompt-btn').addEventListener('click', () => viewPrompt(prompt.id));
                
                return promptDiv;
            }
            
            function getCategoryName(categoryId) {
                const category = categories.find(cat => cat.id === categoryId);
                return category ? category.name : categoryId;
            }
            
            function viewPrompt(id) {
                const prompt = prompts.find(p => p.id === id);
                if (!prompt) return;
                
                currentPromptId = id;
                
                // Encontrar a categoria
                const category = categories.find(cat => cat.id === prompt.category);
                const categoryName = category ? category.name : prompt.category;
                const categoryColor = category ? category.color : 'gray';
                const categoryClass = getCategoryColorClassForBadge(categoryColor);
                
                // Atualizar modal com os dados do prompt
                document.getElementById('modal-prompt-title').textContent = prompt.title;
                document.getElementById('modal-prompt-category').textContent = categoryName;
                document.getElementById('modal-prompt-category').className = `inline-block px-2 py-1 text-xs font-medium rounded-full ${categoryClass}`;
                document.getElementById('modal-prompt-date').textContent = new Date(prompt.date).toLocaleDateString('pt-BR');
                document.getElementById('modal-prompt-text').textContent = prompt.prompt;
                
                // Atualizar tags
                const tagsContainer = document.getElementById('modal-prompt-tags');
                tagsContainer.innerHTML = '';
                
                if (prompt.tags.length > 0) {
                    prompt.tags.forEach(tag => {
                        const tagElement = document.createElement('span');
                        tagElement.className = 'inline-block px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded';
                        tagElement.textContent = tag;
                        tagsContainer.appendChild(tagElement);
                    });
                } else {
                    tagsContainer.innerHTML = '<span class="text-gray-500 dark:text-gray-400">Nenhuma tag</span>';
                }
                
                // Mostrar modal
                promptModal.classList.remove('hidden');
            }
            
            function copyPromptToClipboard() {
                const prompt = prompts.find(p => p.id === currentPromptId);
                if (!prompt) return;
                
                navigator.clipboard.writeText(prompt.prompt)
                    .then(() => {
                        showNotification('Prompt copiado para a área de transferência!', 'success');
                    })
                    .catch(err => {
                        console.error('Erro ao copiar: ', err);
                        showNotification('Erro ao copiar o prompt', 'error');
                    });
            }
            
            function editPrompt() {
                // Implementar edição de prompt
                showNotification('Funcionalidade de edição em desenvolvimento', 'info');
            }
            
            function deletePrompt() {
                if (!currentPromptId) return;
                
                if (confirm('Tem certeza que deseja excluir este prompt?')) {
                    prompts = prompts.filter(p => p.id !== currentPromptId);
                    savePrompts();
                    updatePromptsList();
                    promptModal.classList.add('hidden');
                    showNotification('Prompt excluído com sucesso!', 'success');
                }
            }
            
            function exportPrompts() {
                const data = {
                    prompts: prompts,
                    categories: categories
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'prompts-ia.json';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                showNotification('Prompts e categorias exportados com sucesso!', 'success');
            }
            
            function importPrompts(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        // Verificar se é um arquivo com a estrutura correta
                        if (importedData.prompts && Array.isArray(importedData.prompts)) {
                            // Adicionar IDs únicos para prompts sem ID
                            importedData.prompts.forEach(prompt => {
                                if (!prompt.id) {
                                    prompt.id = Date.now().toString() + Math.random().toString(36).substr(2, 9);
                                }
                            });
                            
                            prompts = [...prompts, ...importedData.prompts];
                            
                            // Importar categorias se existirem
                            if (importedData.categories && Array.isArray(importedData.categories)) {
                                // Adicionar apenas categorias que não existem
                                importedData.categories.forEach(importedCat => {
                                    if (!categories.find(cat => cat.id === importedCat.id)) {
                                        categories.push(importedCat);
                                    }
                                });
                                updateCategoriesSelect();
                            }
                            
                            savePrompts();
                            updatePromptsList();
                            showNotification('Prompts importados com sucesso!', 'success');
                        } else {
                            showNotification('Formato de arquivo inválido', 'error');
                        }
                    } catch (error) {
                        console.error('Erro ao importar:', error);
                        showNotification('Erro ao importar arquivo', 'error');
                    }
                };
                
                reader.readAsText(file);
                // Resetar o input para permitir importar o mesmo arquivo novamente
                e.target.value = '';
            }
            
            function clearAllPrompts() {
                if (prompts.length === 0) {
                    showNotification('Não há prompts para limpar', 'info');
                    return;
                }
                
                if (confirm('Tem certeza que deseja excluir todos os prompts? Esta ação não pode ser desfeita.')) {
                    prompts = [];
                    savePrompts();
                    updatePromptsList();
                    showNotification('Todos os prompts foram excluídos', 'success');
                }
            }
            
            function savePrompts() {
                localStorage.setItem('prompts', JSON.stringify(prompts));
            }
            
            function showNotification(message, type) {
                // Criar elemento de notificação
                const notification = document.createElement('div');
                notification.className = `fixed top-4 right-4 p-4 rounded-md shadow-lg text-white z-50 transform transition-transform duration-300 ${
                    type === 'success' ? 'bg-green-500' : 
                    type === 'error' ? 'bg-red-500' : 
                    'bg-blue-500'
                }`;
                notification.textContent = message;
                
                // Adicionar ao DOM
                document.body.appendChild(notification);
                
                // Remover após 3 segundos
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }
        });
    </script>
</body>
</html>